<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Midgarverse | Home</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script type="importmap">
        {
          "imports": {
            "three": "https://unpkg.com/three/build/three.module.js",
            "OrbitControls":"https://unpkg.com/three/examples/jsm/controls/OrbitControls.js",
            "GLTFLoader":"https://unpkg.com/three/examples/jsm/loaders/GLTFLoader.js",
            "OutlineEffect":"https://unpkg.com/three/examples/jsm/effects/OutlineEffect.js"
          }
        }
    </script>
    <script type="module">
        import * as THREE from "three";
        import { OrbitControls } from "OrbitControls";
        import { GLTFLoader } from "GLTFLoader";
        import { OutlineEffect } from "OutlineEffect";
        const scene = new THREE.Scene();

        const cam2Group = new THREE.Group();
        const cameraGroup = new THREE.Group()
        cam2Group.add(cameraGroup);
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        cameraGroup.add(camera);
        scene.add(cam2Group);

        const bal = new THREE.SphereGeometry(0.0625, 32, 16);
        const ball = new THREE.Mesh(bal, new THREE.MeshBasicMaterial({ color: 0xff0000 }));
        // scene.add(ball);

        const canvas = document.querySelector('canvas.webgl');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        const table = document.querySelector('div.floating');

        const renderer = new THREE.WebGLRenderer({ canvas: canvas, antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.shadowMap.enabled = true;
        renderer.shadowMap.type = THREE.PCFSoftShadowMap;

        let lastKnownScr = 0;
        let ticking = false;

        const plight = new THREE.PointLight(0xffefdf, 1, 50, 0.05);
        plight.castShadow = true;
        plight.shadow.mapSize.width = 2048;
        plight.shadow.mapSize.height = 2048;
        plight.shadow.camera.near = 0.1;
        plight.shadow.camera.far = 40;
        plight.shadow.focus = 1
        plight.shadow.bias = -0.002;
        plight.position.set(0, 4, 0);

        scene.add(plight);

        scene.background = new THREE.Color(0x222222);
        scene.fog = new THREE.FogExp2(0x222222, 0.025);

        const geometry = new THREE.TorusBufferGeometry(2, 0.06, 100, 100);

        const colors = new Uint8Array(10);

        const format = (renderer.capabilities.isWebGL2) ? THREE.RedFormat : THREE.LuminanceFormat;
        for (let c = 0; c <= colors.length; c++) {
            colors[c] = (c / colors.length) * 256;
        }
        const gradientMap = new THREE.DataTexture(colors, colors.length, 1, format);
        gradientMap.needsUpdate = true;

        const floorgeo = new THREE.PlaneBufferGeometry(200, 200, 1, 1);

        var texture = document.createElement('canvas');
        texture.width = texture.height = 500;
        var ctx = texture.getContext('2d');
        var x = 250,
            y = 250,
            innerRadius = 0,
            outerRadius = 200,
            radius = 200;
        var gradient = ctx.createRadialGradient(x, y, innerRadius, x, y, outerRadius);
        gradient.addColorStop(0, 'rgb(50,50,50)');
        gradient.addColorStop(0.5, 'rgb(34,34,34)');
        ctx.fillStyle = gradient;
        ctx.fillRect(0, 0, 500, 1500);
        var texture = new THREE.Texture(texture);
        texture.needsUpdate = true;
        var cGradMaterial = new THREE.MeshStandardMaterial({
            map: texture,
            roughness: 1.0,
            metalness: 0.0,
        });


        const floor = new THREE.Mesh(floorgeo, cGradMaterial);
        floor.rotation.set(-0.5 * Math.PI, 0, 0)
        floor.position.set(0, 0, 0);
        floor.receiveShadow = true;
        scene.add(floor);

        const loader = new GLTFLoader();
        loader.load('models/combat.glb', function (gltf) {
            for (let i = 0; i < gltf.scene.children.length; i++) {
                const element = gltf.scene.children[i];
                element.castShadow = true;
                element.receiveShadow = true;
            }
            scene.add(gltf.scene);
            animate();
        });

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
            render();
        }, false);

        const effect = new OutlineEffect(renderer, { "defaultThickness": 0.0005, "defaultColor": [0.25, 0.25, 0.25] });

        function animate() {

            requestAnimationFrame(animate);
            render();
        }
        const camPositionsX = [0, 0, 0, -3.6, -3.6, -2.65, -2.65, -3.15, -3.15, 2, 2, 2.5, 2.5,];
        const camPositionsY = [1.4, 1.4, 1.4, 1.5, 1.5, 1.2, 1.2, 1.3, 1.3, 1.2, 1.2, 1.4, 1.4, 1.5, 1.5,];
        const camPositionsZ = [0, 0, 0, -3.6, -3.6, 2.6, 2.6, -1, -1, 1.9, 1.9, -2.5, -2.5,];

        const cursor = {}
        cursor.x = 0
        cursor.y = 0

        window.addEventListener('mousemove', (event) => {
            cursor.x = event.clientX / window.innerWidth - 0.5
            cursor.y = event.clientY / window.innerHeight - 0.5
        })

        function lerp(before, after, atPoint) {
            return before + (after - before) * atPoint;
        };

        window.onscroll = function () { scrollFunction() };

        function scrollFunction() {
            var logo = document.getElementById("logo");
            var l4 = 2400;
            var l3 = 1800;
            var l2 = 1000;
            var l1 = 500;

            if (document.documentElement.scrollTop > l4) {
                var interp = ((document.documentElement.scrollTop - l4) / (l4 - l3));
                logo.style.width = "20vw";
                logo.style.marginTop = "12px";
                logo.style.marginLeft = "2vw";


                cameraGroup.position.set(0, 0, 0)
            } else {
                if (document.documentElement.scrollTop > l3) {
                    var interp = ((document.documentElement.scrollTop - l3) / (l3 - l2));
                    logo.style.width = "20vw";
                    logo.style.marginTop = "12px";
                    logo.style.marginLeft = "2vw";


                    cameraGroup.position.set(0, 0, 0)
                } else {
                    if (document.documentElement.scrollTop > l2) {
                        var interp = ((document.documentElement.scrollTop - l2) / (l2 - l1));
                        logo.style.width = 40 - (20 * interp) + "vw";
                        logo.style.marginTop = 54 - (30 * interp) + "px";
                        logo.style.marginLeft = 12 - (10 * interp) + "vw";


                        cameraGroup.position.set(0, 3 * (1 - interp), 0)
                    } else {
                        if (document.documentElement.scrollTop > l1) {
                            var interp = ((document.documentElement.scrollTop - l1) / (l2 - l1));
                            logo.style.width = 60 - (20 * interp) + "vw";
                            logo.style.marginTop = 72 - (18 * interp) + "px";
                            logo.style.marginLeft = 20 - (8 * interp) + "vw";


                            cameraGroup.position.set(0, 3, 0)
                        } else {
                            logo.style.width = "60vw";
                            logo.style.marginTop = "72px";
                            logo.style.marginLeft = "20vw";


                            cameraGroup.position.set(0, 3, 0)
                        }
                    }
                }
            }
        }

        const uniTime = 1;

        function render() {
            var time = uniTime * performance.now() * 0.001;
            var delta = performance.delta;
            var docLen = document.height;

            var proportion = (camPositionsX.length) * window.scrollY / (18000 * 1.1 - window.innerHeight);
            var index = Math.floor(proportion);
            var position = proportion - index;
            var posX = lerp(camPositionsX[index], camPositionsX[(index + 1 == camPositionsX.length ? index : index + 1)], position);
            var posY = lerp(camPositionsY[index], camPositionsY[(index + 1 == camPositionsY.length ? index : index + 1)], position);
            var posZ = lerp(camPositionsZ[index], camPositionsZ[(index + 1 == camPositionsZ.length ? index : index + 1)], position);

            cam2Group.position.set(posX, posY, posZ)
            ball.position.set(posX, posY, posZ)

            var camGPosX = 3 + 6.2832 * cursor.x + time * 0.05
            var camGPosY = -1.25 - 3 * cursor.y

            camera.position.set(3 * Math.cos(camGPosX), -camGPosY, 3 * Math.sin(camGPosX))
            camera.lookAt(posX, posY, posZ);

            effect.render(scene, camera);

        }

        animate();


    </script>
    <style>
        @font-face {
            font-family: 'Inknut Antiqua';
            font-style: normal;
            font-weight: 600;
            src: local(''),
                url('./fonts/inknut-antiqua-v12-latin-600.woff2') format('woff2'),
                /* Chrome 26+, Opera 23+, Firefox 39+ */
                url('./fonts/inknut-antiqua-v12-latin-600.woff') format('woff');
            /* Chrome 6+, Firefox 3.6+, IE 9+, Safari 5.1+ */
        }

        html {
            scroll-behavior: smooth;
            min-height: 100vh;
        }

        body {
            margin: 0px;
            height: 18000px;
        }

        .floating {
            background-color: rgba(0, 0, 0, 0);
            text-align: center;
            overflow-y: hidden;
        }

        h1 {
            font-family: 'Inknut Antiqua';
            font-size: 2vh;
            position: relative;
            color: #fff;
        }

        h2 {
            font-family: 'Inknut Antiqua';
            font-size: 1.5vh;
            position: relative;
            color: #fff;
        }

        p {
            position: relative;
            font-size: 1.2vh;
            line-height: 2vh;
            color: #fff;
        }

        .div-table {
            display: table;
            width: 85%;
            margin: 7.5%;
            overflow-y: hidden;
        }

        .div-table-row {
            display: table-row;
            clear: both;
            margin: 7.5%;
        }

        .div-table-col {
            float: left;
            display: table-column;
            color: #fff;
            width: 33vw;
            margin-top: 7vh;
        }
    </style>
</head>

<body>

    <canvas class="webgl" style="position:fixed; top:0vh; left:0vw;" zIndex="-1"></canvas>
    <img src="./images/logo.png" id="logo"
        style="position:fixed; top:0vh; left:0vw; text-align: center; overflow-y: hidden; width:60vw; margin-top:72px; margin-left:20vw;"
        zIndex="5555">
    <!-- <div class="topFixed" style="position:fixed; top:0vh; left:0vw; text-align: center; color: #fff;overflow-y: hidden;"
        zIndex="5555">
        <div class="div-table-row" style="width:100vw; margin: 0%;" zIndex="26">
            <div class="div-table-col"><img src="./images/logo.png" id="logo"
                    style="width:42vw; margin-top:60px; margin-left:24px;"/></div>
            <div class="div-table-col">ROADMAP</div>
            <div class="div-table-col">CONNECT</div>
        </div>
    </div> -->

    <div id="scrollable" class="floating"
        style="text-align:center; top:12vh; margin-top:12vh; padding-top:12vh; overflow:scroll">
        <div id="mainTable">
            <div style="margin-top:4500px;">
                <h2>Explore the wondrous and often unforgiving world of the Vikings</h2>
                <p>Set in the Iron Age, Midgarverse promises to deliver an immersive experience for players looking to
                    explore and fight their way to fame and glory.</p>
            </div>
            <div style="margin-top:2900px;">
                <h2>Establish sprawling Trade Empires and unstoppable Military Alliances</h2>
                <p>Social contracts allow players to create binding oaths, enabling rich commerce and military
                    collaborative play.<br>
                    Via Trade Contracts, Vikings can control the supply and demand of commodities for kingdoms and
                    empires well beyond the borders of Viking Scandinavia.<br>
                    Owned land provides further opportunity to foster relationships and boost trade income and military
                    stability.</p>
            </div>
            <div style="margin-top:2900px;">
                <h2>Brave the stormy and icy waves with the likes of Harald Bluetooth, Hrafna-Floki and Leif Erikson
                </h2>
                <p>Players must engage in the prominent Viking tradition of seafaring. Join the Clan Fleet, or command
                    your own vessel as you set forth to unchartered waters.<br>
                    Hostile raids, trade missions, and exploration journeys each offer unique ways of increasing a
                    Viking's fame and wealth</p>
            </div>
            <div style="margin-top:2900px;">
                <h2>Secure your land, gather its resources, and fortify your position</h2>
                <p>Land ownership opens a whole world of opportunities. From logging and hunting, to farming, smithing
                    and shipbuilding, owning land gives Vikings the chance to generate natural and fabricated
                    resources.<br>
                    Moreover, each land has a number of construction slots which can be developed to suit the owner's
                    needs.<br>
                    Each type of construction has its own aesthetics and benefits to the landowner.<br>
                    Land can be gained as a conquest of enemy lands following raids and battles, as a discovery when
                    exploring new lands to settle, or as part of a trade arrangement with foreign kingdoms.<br>
                    Rental contracts allow Vikings to lease and rent land from other Vikings, increasing the
                    accessibility of rare materials and generating passive income for landowners.
                </p>
            </div>
            <div style="margin-top:2900px;">
                <h2>Trample armies and topple kingdoms for the glory of Odin</h2>
                <p>It is a time of change and conflict for the Vikings. <br>
                    The expansion of the Holy Roman Empire and other Christian kingdoms threatens our ways. The Volvas
                    have been shown the death of our gods. <br>
                    We must fight and die with glory. That is the Viking way.
                </p>
            </div>
        </div>

    </div>

</body>

</html>